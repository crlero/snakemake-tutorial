# installing miniconda3
$ bash Miniconda3-latest-MacOSX-x86_64.sh

# follow the prompts on the installer screens
# test installation
$ conda list

# snakemake installation
# via conda/mamba (recommended)
$ conda install -n base -c conda-forge mamba

# full installation
$ conda activate base
$ mamba create -c conda-forge -c bioconda -n snakemake snakemake
$ conda activate snakemake

# via pip (not recommended)
$ pip install snakemake

# set up channels
$ conda config --add channels defaults
$ conda config --add channels bioconda
$ conda config --add channels conda-forge

# create your environment
$ conda create -n tutorial -c conda-forge mamba
$ conda activate tutorial

# installing new R packages
# from conda
$ conda install snakemake 
$ conda install r-essentials
$ conda install bioconductor-microbiome
$ conda install bioconductor-phyloseq
$ conda install bioconductor-metagenomeseq
$ conda install r-vegan
$ conda install r-cowplot
$ conda install r-ggthemes
$ conda install r-ggsci

# from R (not recommended, and if so add a rule to download the packages)

$ R 
>> if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

>> BiocManager::install("phyloseq")
>> BiocManager::install("microbiome")
>> install.packages("vegan")

# launch RStudio within your workflow environment
$ /Applications/RStudio.app/Contents/MacOS/RStudio

# export your environment
$ conda env export -n tutorial > environment.yml # from outside environment
$ conda env export > environment.yml # from inside environment

# Exit environment
$ conda deactivate

# create conda environment from yaml file
$ conda env create -f environment.yml
# install dependencies into isolated environment
$ conda env create -n myworkflow --file environment.yaml

# create a zip folder with the environment
$ conda install conda-pack
$ conda-pack --name tutorial --output environment_tutorial.tar.gz
$ mkdir environment_tutorial
$ tar xzvf environment_tutorial.tar.gz -C environment_tutorial
$ source environment_tutorial/bin/activate # activate the environment

# sustainable archiving
$ snakemake --archive my-workflow.tar.gz
$ tar -xf my-workflow.tar.gz